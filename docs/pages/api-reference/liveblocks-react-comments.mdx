---
meta:
  title: "@liveblocks/react-comments"
  parentTitle: "API Reference"
  description: "API Reference for the @liveblocks/react-comments package"
alwaysShowAllNavigationLevels: false
---

{/* TODO: Explain the concept of thread metadata */}

## Configuration

### createCommentsContext

Creates a [`CommentsProvider`][] and a set of typed hooks. We recommend using it
in `liveblocks.config.ts` and re-exporting your typed hooks like below.

```tsx file="liveblocks.config.ts"
import { createClient } from "@liveblocks/client";
import { createCommentsContext } from "@liveblocks/react-comments";

const client = createClient({
  /* client options */
});

// Optionally, ThreadMetadata represents metadata on each thread.
// Must only contain scalar values.
type ThreadMetadata = {
  resolved?: boolean;
};

export const {
  CommentsProvider,
  useThreads,
  /* ...all the other hooks you’re using... */
} = createCommentsContext<ThreadMetadata>(client);
```

#### Resolving users [#createCommentsContext.resolveUser]

Anything that is linked to a user (comments, mentions, etc.) will reference
their ID. To display user information based on IDs, you can provide a resolver
function to the `resolveUser` option in [`createCommentContext`][].

This resolver function will receive a user ID and should return a user object
asynchronously.

```tsx file="liveblocks.config.ts"
// ...

export const {
  /* ... */
} = createCommentsContext<ThreadMetadata>(client, {
  resolveUser: (userId) => __getUserInfoFromDB__(userId),
});
```

Once that’s done, components will show user names and avatars accordingly.

{/* TODO: Explain UserInfo.name and UserInfo.avatar which are here by default */}

{/* TODO: Explain that you can go beyond that and use a custom UserInfo type (pass it to createCommentsContext, it should extend the default UserInfo type), then use the useUser hook to get full user objects while using the primitives instead of the components */}

#### Resolving mention suggestions [#createCommentsContext.resolveMentionSuggestions]

Liveblocks only knows users’ IDs, so to enable creating mentions in composer
editors, you can provide a resolver function to the `resolveMentionSuggestions`
option in [`createCommentContext`][].

This resolver function will receive the mention currently being written (e.g.
when writing “@jan”, `text` will be `jan`) and should return a list of user IDs
matching that text. This function will be called every time the text changes but
with some debouncing.

```tsx file="liveblocks.config.ts"
// ...

export const {
  /* ... */
} = createCommentsContext<ThreadMetadata>(client, {
  resolveMentionSuggestions: (text) => __getSuggestedUserIds__(text),
});
```

### CommentsProvider

Makes comments from a room available in the component hierarchy below. Multiple
instances with the same `roomId` can coexist in the same hierarchy.

```tsx
import { CommentsProvider } from "./liveblocks.config";

function Panel() {
  return <CommentsProvider roomId="my-room">{/* children */}</CommentsProvider>;
}
```

## Components

{/* TODO: Explain customization (CSS variables, dark mode, etc.) */}

{/* TODO: Explain overrides */}

### Thread

Displays a thread of comments, with a composer to reply to it.

```tsx
<>
  {threads.map((thread) => (
    <Thread key={thread.id} thread={thread} />
  ))}
</>
```

<Table columns={["auto", "auto", "54%"]}>

| Prop                  | Type                                                                                              | Description                                                                   |
| --------------------- | ------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------- |
| `thread`              | <code>ThreadData&lt;\{ resolved?: boolean \}&gt;</code>                                           | The thread to display.                                                        |
| `showComposer`        | `boolean \| undefined`                                                                            | Whether to show the composer to reply to the thread.<br/>Defaults to `false`. |
| `showActions`         | `boolean \| "hover" \| undefined`                                                                 | How to show or hide the actions.<br/>Defaults to `"hover"`.                   |
| `showResolveAction`   | `boolean \| undefined`                                                                            | Whether to show the action to resolve the thread.<br/>Defaults to `true`.     |
| `indentCommentBody`   | `boolean \| undefined`                                                                            | Whether to indent the comments’ bodies.<br/>Defaults to `true`.               |
| `showDeletedComments` | `boolean \| undefined`                                                                            | Whether to show deleted comments.<br/>Defaults to `false`.                    |
| `onMentionClick`      | <code>(userId: string, event: MouseEvent&lt;HTMLSpanElement&gt;) => void \| undefined</code>      | TODO                                                                          |
| `overrides`           | <code>Partial&lt;ThreadOverrides \& CommentOverrides \& ComposerOverrides&gt; \| undefined</code> | Override the component’s strings.                                             |

</Table>

### Comment

Displays a single comment.

```tsx
<>
  {thread.comments.map((comment) => (
    <Comment key={comment.id} comment={comment} />
  ))}
</>
```

<Table columns={["auto", "auto", "54%"]}>

| Prop             | Type                                                                                         | Description                                                                                                                           |
| ---------------- | -------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------- |
| `comment`        | `CommentData`                                                                                | The thread to display.                                                                                                                |
| `showActions`    | `boolean \| "hover" \| undefined`                                                            | How to show or hide the actions.<br/>Defaults to `"hover"`.                                                                           |
| `indentBody`     | `boolean \| undefined`                                                                       | Whether to indent the comment’s body.<br/>Defaults to `true`.                                                                         |
| `showDeleted`    | `boolean \| undefined`                                                                       | Whether to show the comment if it was deleted. If set to `false`, it will render deleted comments as `null`.<br/>Defaults to `false`. |
| `onMentionClick` | <code>(userId: string, event: MouseEvent&lt;HTMLSpanElement&gt;) => void \| undefined</code> | TODO                                                                                                                                  |
| `overrides`      | <code>Partial&lt;CommentOverrides \& ComposerOverrides&gt; \| undefined</code>               | Override the component’s strings.                                                                                                     |

</Table>

### Composer

Displays a composer to create comments.

```tsx
<Composer />
```

<Table columns={["auto", "auto", "54%"]}>

| Prop           | Type                                                       | Description                                               |
| -------------- | ---------------------------------------------------------- | --------------------------------------------------------- |
| `threadId`     | `string \| undefined`                                      | The ID of the thread to reply to or to edit a comment in. |
| `commentId`    | `string \| undefined`                                      | The ID of the comment to edit.                            |
| `initialValue` | `CommentBody \| undefined`                                 | The editor’s initial value.                               |
| `disabled`     | `boolean \| undefined`                                     | Whether the editor is disabled.                           |
| `overrides`    | <code>Partial&lt;ComposerOverrides&gt; \| undefined</code> | Override the component’s strings.                         |

</Table>

## Hooks

### useThreads

Returns the threads within the current room, from the nearest
[`CommentsProvider`][].

```tsx
import { useThreads } from "./liveblocks.config";

const { threads, error, isLoading } = useThreads();
```

### useUser

Returns user info from a given user ID.

```tsx
import { useUser } from "./liveblocks.config";

const { user, error, isLoading } = useUser("user-id");
```

<Banner title="Providing a resolver function">

To use `useUser`, you should provide a resolver function to the
[`resolveUser`](#createCommentsContext.resolveUser) option in
[`createCommentContext`](#createCommentContext).

</Banner>

### useCreateThread

Returns a function that creates a thread with an initial comment, and optionally
some metadata.

```tsx
const createThread = useCreateThread();
const thread = createThread("room-id", { body: {}, metadata: {} });
```

### useEditThread

Returns a function that edits a thread’s metadata.

```tsx
const editThread = useEditThread();
const thread = editThread("room-id", { threadId: "th_xxx", metadata: {} });
```

### useCreateComment

Returns a function that adds a comment to a thread.

```tsx
const createComment = useCreateComment();
const comment = createComment("room-id", { threadId: "th_xxx", body: {} });
```

### useEditComment

Returns a function that edits a comment’s body.

```tsx
const editComment = useEditComment();
const comment = editComment("room-id", {
  threadId: "th_xxx",
  commentId: "cm_xxx",
  body: {},
});
```

### useDeleteComment

Returns a function that deletes a comment. If it is the last non-deleted
comment, the thread also gets deleted.

```tsx
const deleteComment = useDeleteComment();
deleteComment("room-id", { threadId: "th_xxx", commentId: "cm_xxx" });
```

### useErrorListener

Listen to potential errors when creating and editing threads/comments.

```tsx
useErrorListener((error) => {
  console.error(error);
});
```

### useComposer

Returns states and methods related to the composer. Can only be used within
`Composer.Form`.

```tsx
const { isValid, submit } = useComposer();
```

### useRoomId

Returns the current room ID, from the nearest [`CommentsProvider`][].

```tsx
const roomId = useRoomId();
```

## Primitives

Primitives are unopinionated and unstyled components that can be used to create
custom experiences with full control.

### Comment [#primitives-Comment]

```tsx title="Anatomy"
import { Comment } from "@liveblocks/react-comments/primitives";

() => <Comment.Body renderMention={() => <Comment.Mention />} />;
```

#### Comment.Body [#primitives-Comment.Body]

Displays a comment body.

```tsx
<Comment.Body body={comment.body} />
```

<Table columns={["auto", "auto", "54%"]}>

| Prop            | Type                                                                     | Description                                                                                     |
| --------------- | ------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------- |
| `body`          | `CommentBody \| undefined`                                               | The comment body to display. If not defined, the component will render `null`.                  |
| `renderMention` | <code>ComponentType&lt;CommentRenderMentionProps&gt; \| undefined</code> | The component used to render mentions.<br/>Defaults to the mention’s `userId` prefixed by an @. |
| `asChild`       | `boolean \| undefined`                                                   | Replace the rendered element by the one passed as a child.<br/>Defaults to `false`.             |

</Table>

##### renderMention [#primitives-Comment.Body-renderMention]

A render prop that accepts a component used to render mentions.

```tsx
<Comment.Body
  renderMention={({ userId }) => <Comment.Mention>@{userId}</Comment.Mention>}
/>
```

<Table columns={["auto", "auto", "54%"]}>

| Prop     | Type     | Description            |
| -------- | -------- | ---------------------- |
| `userId` | `string` | The mention’s user ID. |

</Table>

#### Comment.Mention [#primitives-Comment.Mention]

Displays mentions within `Comment.Body`’s `renderMention` prop.

```tsx
<Comment.Mention>@{userId}</Comment.Mention>
```

<Table columns={["auto", "auto", "54%"]}>

| Prop      | Type                   | Description                                                                         |
| --------- | ---------------------- | ----------------------------------------------------------------------------------- |
| `asChild` | `boolean \| undefined` | Replace the rendered element by the one passed as a child.<br/>Defaults to `false`. |

</Table>

### Composer [#primitives-Composer]

```tsx title="Anatomy"
import { Composer } from "@liveblocks/react-comments";

() => (
  <Composer.Form>
    <Composer.Editor
      renderMention={() => <Composer.Mention />}
      renderMentionSuggestions={() => (
        <Composer.Suggestions>
          <Composer.SuggestionsList>
            <Composer.SuggestionsListItem />
          </Composer.SuggestionsList>
        </Composer.Suggestions>
      )}
    />
    <Composer.Submit />
  </Composer.Form>
);
```

#### Composer.Form [#primitives-Composer.Form]

Surrounds the composer’s content and handles submissions.

```tsx
<Composer.Form onComposerSubmit={({ body }) => {}}>
  <Composer.Editor />
  <Composer.Submit />
</Composer.Form>
```

<Table columns={["auto", "auto", "54%"]}>

| Prop               | Type                                                                                                                                 | Description                                                                         |
| ------------------ | ------------------------------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------- |
| `onComposerSubmit` | <code>((comment: ComposerSubmitComment, event: FormEvent&lt;HTMLFormElement&gt;) => Promise&lt;void&gt; \| void) \| undefined</code> | The event handler called when the form is submitted.                                |
| `asChild`          | `boolean \| undefined`                                                                                                               | Replace the rendered element by the one passed as a child.<br/>Defaults to `false`. |

</Table>

#### Composer.Editor [#primitives-Composer.Editor]

Displays the composer’s editor.

```tsx
<Composer.Editor placeholder="Write a comment…" />
```

<Table columns={["auto", "auto", "54%"]}>

| Prop                        | Type                                                                                 | Description                                                                                            |
| --------------------------- | ------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------ |
| `initialValue`              | `CommentBody \| undefined`                                                           | The editor’s initial value.                                                                            |
| `placeholder`               | `string \| undefined`                                                                | The text to display when the editor is empty.                                                          |
| `disabled`                  | `boolean \| undefined`                                                               | Whether the editor is disabled.                                                                        |
| `autoFocus`                 | `boolean \| undefined`                                                               | Whether to focus the editor on mount.                                                                  |
| `dir`                       | `"ltr" \| "rtl" \| undefined`                                                        | The reading direction of the editor and related elements.                                              |
| `renderMention`             | <code>ComponentType&lt;ComposerRenderMentionProps&gt; \| undefined</code>            | The component used to render mentions.<br/>Defaults to the mention’s `userId` prefixed by an @.        |
| `renderMentionSuggestions`  | <code>ComponentType&lt;ComposerRenderMentionSuggestionsProps&gt; \| undefined</code> | The component used to render mention suggestions.<br/>Defaults to a list of the suggestions’ `userId`. |
| `resolveMentionSuggestions` | <code>(text: string) => Promise&lt;string[]&gt; \| undefined</code>                  | An asynchronous function to get a list of suggested user IDs from a string.                            |

</Table>

<Table columns={["28%", "auto"]}>

| Attribute       | Value                                   |
| --------------- | --------------------------------------- |
| `data-focused`  | Present when the component is focused.  |
| `data-disabled` | Present when the component is disabled. |

</Table>

##### renderMention [#primitives-Composer.Editor-renderMention]

A render prop that accepts a component used to render mentions.

```tsx
<Composer.Editor
  renderMention={({ userId, isSelected }) => (
    <Composer.Mention>@{userId}</Composer.Mention>
  )}
/>
```

<Table columns={["auto", "auto", "54%"]}>

| Prop         | Type      | Description                      |
| ------------ | --------- | -------------------------------- |
| `userId`     | `string`  | The mention’s user ID.           |
| `isSelected` | `boolean` | Whether the mention is selected. |

</Table>

##### renderMentionSuggestions [#primitives-Composer.Editor-renderMentionSuggestions]

A render prop that accepts a component used to render mention suggestions.

<Table columns={["auto", "auto", "54%"]}>

| Prop             | Type                  | Description                     |
| ---------------- | --------------------- | ------------------------------- |
| `userIds`        | `string[]`            | The list of suggested user IDs. |
| `selectedUserId` | `string \| undefined` | The currently selected user ID. |

</Table>

```tsx
<Composer.Editor
  renderMentionSuggestions={() => (
    <Composer.Suggestions>
      <Composer.SuggestionsList>
        <Composer.SuggestionsListItem />
      </Composer.SuggestionsList>
    </Composer.Suggestions>
  )}
/>
```

#### Composer.Mention [#primitives-Composer.Mention]

Displays mentions within `Composer.Editor`’s `renderMention` prop.

```tsx
<Composer.Mention>@{userId}</Composer.Mention>
```

<Table columns={["auto", "auto", "54%"]}>

| Prop      | Type                   | Description                                                                         |
| --------- | ---------------------- | ----------------------------------------------------------------------------------- |
| `asChild` | `boolean \| undefined` | Replace the rendered element by the one passed as a child.<br/>Defaults to `false`. |

</Table>

<Table columns={["28%", "auto"]}>

| Attribute       | Value                                 |
| --------------- | ------------------------------------- |
| `data-selected` | Present when the mention is selected. |

</Table>

#### Composer.Suggestions [#primitives-Composer.Suggestions]

Surrounds a list of suggestions within `Composer.Editor`.

```tsx
<Composer.Suggestions>
	<Composer.SuggestionsList>
	  {/* … */}
	</Composer.SuggestionsList>
<Composer.Suggestions>
```

<Table columns={["auto", "auto", "54%"]}>

| Prop      | Type                   | Description                                                                         |
| --------- | ---------------------- | ----------------------------------------------------------------------------------- |
| `asChild` | `boolean \| undefined` | Replace the rendered element by the one passed as a child.<br/>Defaults to `false`. |

</Table>

#### Composer.SuggestionsList [#primitives-Composer.SuggestionsList]

Displays a list of suggestions within `Composer.Editor`.

```tsx
<Composer.SuggestionsList>{/* … */}</Composer.SuggestionsList>
```

<Table columns={["auto", "auto", "54%"]}>

| Prop      | Type                   | Description                                                                         |
| --------- | ---------------------- | ----------------------------------------------------------------------------------- |
| `asChild` | `boolean \| undefined` | Replace the rendered element by the one passed as a child.<br/>Defaults to `false`. |

</Table>

#### Composer.SuggestionsListItem [#primitives-Composer.SuggestionsListItem]

Displays a suggestion within `Composer.SuggestionsList`.

```tsx
<Composer.SuggestionsList>
  {userIds.map((userId) => (
    <Composer.SuggestionsListItem key={userId} value={userId}>
      @{userId}
    </Composer.SuggestionsListItem>
  ))}
</Composer.SuggestionsList>
```

<Table columns={["auto", "auto", "54%"]}>

| Prop      | Type                   | Description                                                                         |
| --------- | ---------------------- | ----------------------------------------------------------------------------------- |
| `value`   | `string`               | The suggestion’s value.                                                             |
| `asChild` | `boolean \| undefined` | Replace the rendered element by the one passed as a child.<br/>Defaults to `false`. |

</Table>

<Table columns={["28%", "auto"]}>

| Attribute       | Value                              |
| --------------- | ---------------------------------- |
| `data-selected` | Present when the item is selected. |

</Table>

#### Composer.Submit [#primitives-Composer.Submit]

A button to submit the composer.

```tsx
<Composer.Submit>Send</Composer.Submit>
```

<Table columns={["auto", "auto", "54%"]}>

| Prop      | Type                   | Description                                                                         |
| --------- | ---------------------- | ----------------------------------------------------------------------------------- |
| `asChild` | `boolean \| undefined` | Replace the rendered element by the one passed as a child.<br/>Defaults to `false`. |

</Table>

### Timestamp [#primitives-Timestamp]

Displays a formatted date, and automatically re-renders to support relative
formatting. Defaults to relative formatting for recent dates and a short
absolute formatting for older ones.

```tsx
<Timestamp date={new Date()} />
```

<Table columns={["auto", "auto", "54%"]}>

| Prop       | Type                                              | Description                                                                                                                                 |
| ---------- | ------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------- |
| `date`     | `Date \| string \| number`                        | The date to display.                                                                                                                        |
| `children` | `((date: Date) => ReactNode) \| undefined`        | A function to format the displayed date.<br/>Defaults to a relative date formatting function.                                               |
| `title`    | `string \| ((date: Date) => string) \| undefined` | The `title` attribute’s value or a function to format it.<br/>Defaults to an absolute date formatting function.                             |
| `interval` | `number \| false \| undefined`                    | The interval in milliseconds at which the component will re-render. Can be set to `false` to disable re-rendering.<br/>Defaults to `30000`. |
| `asChild`  | `boolean \| undefined`                            | Replace the rendered element by the one passed as a child.<br/>Defaults to `false`.                                                         |

</Table>

[`createCommentContext`]:
  /docs/api-reference/liveblocks-react-comments#createCommentContext
[`commentsprovider`]:
  /docs/api-reference/liveblocks-react-comments#CommentsProvider
